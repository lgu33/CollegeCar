{% extends "/layout.html" %}
{% block content %}
<br></br>
<h2>{{title}}</h2>
{% if rs_pid %}
    <h4>Reddit Scraper and Flagger are Running </h4>
{% else %}
    <h4>Reddit Scraper and Flagger is Not Running</h4>
{% endif %}
<button type="button" class="btn btn-primary" data-toggle="collapse" data-target="#auto_messenger">Auto Messenger</button>
    <br>
  <div id="auto_messenger" class="collapse">
      <form name="my-form" method="POST" action="">
        {{ auto_messenger_form.hidden_tag() }}
        <fieldset class="form-group">
            <div class="form-group row">
                {{ auto_messenger_form.number_of_messages.label(class="col-md-4 col-form-label text-md-right") }}
                <div class="col-md-6">
                {% if auto_messenger_form.number_of_messages.errors %}
                    {{ auto_messenger_form.number_of_messages(class="form-control form-control is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in auto_messenger_form.number_of_messages.errors %}
                            <span> {{ error }} </span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ auto_messenger_form.number_of_messages(class="form-control") }}
                {% endif %}
                </div>
            </div>
            <div class="form-group row">
                {{ auto_messenger_form.sleep_time.label(class="col-md-4 col-form-label text-md-right") }}
                <div class="col-md-6">
                {% if auto_messenger_form.sleep_time.errors %}
                    {{ auto_messenger_form.sleep_time(class="form-control form-control is-invalid") }}
                    <div class="invalid-feedback">
                        {% for error in auto_messenger_form.sleep_time.errors %}
                            <span> {{ error }} </span>
                        {% endfor %}
                    </div>
                {% else %}
                    {{ auto_messenger_form.sleep_time(class="form-control") }}
                {% endif %}
                </div>
            </div>
        </fieldset>
        <input name="auto_message" type="submit" value="Begin Auto Messenger" class="btn btn-success"/>
    </form>
    </form>
  </div>



{% if records.empty %}
    <br>
    <br>
    <h5>Still no complainers!</h5>
{% endif%}

{% endblock content %}

{% block content2 %}
<br></br>
{% if not records.empty %}
    <table class="table table-striped">
        <tr>

            <th>ID</th>
            <th>LANG</th>
            <th>FOUND</th>
            <th>COMMENT DATE</th>
            <th>USERNAME</th>
            <th>COMMENT</th>
            <th>LINK</th>
            <th>SUB</th>
            <th>POST TITLE</th>
            <th>DETAILS</th>

        </tr>
        {% for index, row in records.iterrows() %}
            {% set row_dict = row.to_dict() %}
            <tr>
                <td>{{ row['ID'] | safe }}</td>
                <td>{{ row['Language'] | safe }}</td>
                <td width="9%">{{ row['Date Found'] | safe }}</td>
                <td width="9%">{{ row['Comment Date'] | safe }}</td>
                <td width="2%">{{ row['Username'] | safe }}</td>
                <td>{{ row['Comment'] | truncate(200) | safe }}</td>
                <td>{{ row['Link'] | safe }}</td>
                <td>{{ row['r/'] | safe }}</td>
                <td>{{ row['Submission Title'] | truncate(25) | safe }}</td>
                <td>{{ row['See Details'] | safe }}</td>

            </tr>
        {% endfor %}
    </table>
{% endif %}
<script type="text/javascript" src="{{ url_for('static', filename='reddit_scraper.js') }}"></script>
{% endblock content2 %}